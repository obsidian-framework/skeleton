<section id="sse">
    <h2 class="text-3xl font-bold text-white mb-6">Server-Sent Events (SSE)</h2>

    <p class="text-gray-400 mb-6">
        SSE enables real-time server-to-client streaming. Perfect for notifications, live dashboards,
        and activity feeds. Automatic reconnection included.
    </p>

    <div class="space-y-6">
        <div>
            <div class="text-gray-400 text-sm mb-3">Basic SSE endpoint</div>
            <div class="bg-zinc-950 border border-zinc-800 p-6">
                <pre class="line-numbers"><code class="language-java">@Controller
public class NotificationController {

    @SSE(value = "/notifications/stream", name = "notifications.stream")
    public Object stream(Request req, Response res) {
        res.raw().setCharacterEncoding("UTF-8");
        PrintWriter writer = res.raw().getWriter();

        try {
            for (int i = 0; i &lt; 10; i++) {
                String notification = String.format(
                    "{\"type\":\"Info\",\"message\":\"Event %d\"}",
                    i
                );

                // SSE format: "data: JSON\n\n"
                writer.write("data: " + notification + "\n\n");
                writer.flush();

                Thread.sleep(5000);
            }
        } catch (Exception e) {
            // Client disconnected
        } finally {
            writer.close();
        }

        return null;
    }
}</code></pre>
            </div>
        </div>

        <div>
            <div class="text-gray-400 text-sm mb-3">Client-side JavaScript</div>
            <div class="bg-zinc-950 border border-zinc-800 p-6">
                <pre class="line-numbers"><code class="language-javascript">const eventSource = new EventSource('/notifications/stream');

eventSource.onmessage = (event) => {
    const data = JSON.parse(event.data);
    console.log('Notification:', data);
};

eventSource.onerror = (error) => {
    console.error('Connection error');
    // Automatically reconnects
};

// Close when done
eventSource.close();</code></pre>
            </div>
        </div>

        <div>
            <div class="text-gray-400 text-sm mb-3">Message format</div>
            <div class="bg-zinc-950 border border-zinc-800 p-6">
                <p class="text-gray-400 mb-4">
                    SSE messages follow a simple text format. Each event must end with two newlines.
                </p>
                <pre class="line-numbers"><code class="language-java">// Simple text message
writer.write("data: Hello World\n\n");

// JSON message (recommended)
writer.write("data: {\"user\":\"Alice\",\"message\":\"Hi!\"}\n\n");

// Named event (optional)
writer.write("event: notification\n");
writer.write("data: {\"text\":\"New message\"}\n\n");</code></pre>
            </div>
        </div>

        <div class="bg-zinc-900 border border-zinc-800 p-6 rounded">
            <div class="text-blue-400 mb-2">ðŸ’¡ Important</div>
            <p class="text-gray-400 text-sm mb-3">
                Always set UTF-8 encoding to avoid charset issues:
            </p>
            <pre class="text-sm"><code class="language-java">res.raw().setCharacterEncoding("UTF-8");</code></pre>
        </div>
    </div>
</section>