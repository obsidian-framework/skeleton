<section id="csrf">
    <h2 class="text-3xl font-bold text-white mb-6">CSRF Protection</h2>

    <p class="text-gray-400 mb-6">
        Automatic protection against Cross-Site Request Forgery attacks.
    </p>

    <div class="space-y-6">
        <div>
            <div class="text-gray-400 text-sm mb-3">Enable protection on a route</div>
            <div class="bg-zinc-950 border border-zinc-800 p-6">
                <pre class="line-numbers"><code class="language-java">@CsrfProtect
@POST(value = "/articles", name = "articles.store")
private Object store(Request req, Response res) {
    // Token validated automatically
    // If invalid â†’ 403 Forbidden
}</code></pre>
            </div>
        </div>

        <div>
            <div class="text-gray-400 text-sm mb-3">In HTML forms</div>
            <div class="bg-zinc-950 border border-zinc-800 p-6">
                <pre class="line-numbers"><code class="language-twig">&lt;form method="POST" action="/articles"&gt;
    {{ "{{" }} csrf_field() | raw {{ "}}" }}

    &lt;input type="text" name="title"&gt;
    &lt;button type="submit"&gt;Create&lt;/button&gt;
&lt;/form&gt;</code></pre>
            </div>
        </div>

        <div>
            <div class="text-gray-400 text-sm mb-3">For AJAX requests</div>
            <div class="bg-zinc-950 border border-zinc-800 p-6">
                <pre class="line-numbers"><code class="language-javascript">const csrfToken = '{{ "{{" }} csrf_token() {{ "}}" }}';

fetch('/articles', {
    method: 'POST',
    headers: {
        'X-CSRF-TOKEN': csrfToken,
        'Content-Type': 'application/json'
    },
    body: JSON.stringify({ title: 'My article' })
});</code></pre>
            </div>
        </div>

        <div>
            <div class="text-gray-400 text-sm mb-3">Regenerate token (after login)</div>
            <div class="bg-zinc-950 border border-zinc-800 p-6">
                <pre class="line-numbers"><code class="language-java">@POST("/login")
private Object login(Request req, Response res) {
    if (isLogged(req)) {
        regenerateCsrfToken(req);
        res.redirect("/dashboard");
    }
    return null;
}</code></pre>
            </div>
        </div>

        <div class="bg-zinc-900 border border-zinc-800 p-6 rounded">
            <div class="text-blue-400 mb-2">ðŸ’¡ Behavior</div>
            <ul class="text-gray-400 text-sm space-y-1">
                <li>â€¢ GET/HEAD/OPTIONS requests are never protected</li>
                <li>â€¢ POST/PUT/DELETE/PATCH require the @CsrfProtect annotation</li>
                <li>â€¢ Token expires after 1 hour of inactivity</li>
                <li>â€¢ Token can be sent via X-CSRF-TOKEN header or _csrf field</li>
            </ul>
        </div>
    </div>
</section>
