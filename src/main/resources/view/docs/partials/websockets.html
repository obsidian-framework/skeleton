<section id="websockets">
    <h2 class="text-3xl font-bold text-white mb-6">WebSockets</h2>

    <p class="text-gray-400 mb-6">
        WebSocket handlers enable bi-directional real-time communication between client and server.
        Perfect for chat applications, live collaboration, and gaming.
    </p>

    <div class="space-y-6">
        <div>
            <div class="text-gray-400 text-sm mb-3">Basic WebSocket handler</div>
            <div class="bg-zinc-950 border border-zinc-800 p-6">
                <pre class="line-numbers"><code class="language-java">@org.eclipse.jetty.websocket.api.annotations.WebSocket
@WebSocket("/ws/chat")
public class ChatHandler {

    private static final Map&lt;Session, String&gt; users = new ConcurrentHashMap&lt;&gt;();

    @OnWebSocketConnect
    public void onConnect(Session session) throws IOException {
        session.getRemote().sendString("Welcome to the chat!");
    }

    @OnWebSocketMessage
    public void onMessage(Session session, String message) throws IOException {
        // Broadcast to all connected users
        for (Session s : users.keySet()) {
            if (s.isOpen()) {
                s.getRemote().sendString(message);
            }
        }
    }

    @OnWebSocketClose
    public void onClose(Session session, int code, String reason) {
        users.remove(session);
    }
}</code></pre>
            </div>
        </div>

        <div>
            <div class="text-gray-400 text-sm mb-3">Client-side JavaScript</div>
            <div class="bg-zinc-950 border border-zinc-800 p-6">
                <pre class="line-numbers"><code class="language-javascript">const ws = new WebSocket('ws://localhost:8888/ws/chat');

ws.onopen = () => {
    console.log('Connected!');
    ws.send('Hello server!');
};

ws.onmessage = (event) => {
    console.log('Received:', event.data);
};

ws.onclose = () => {
    console.log('Disconnected');
};</code></pre>
            </div>
        </div>

        <div>
            <div class="text-gray-400 text-sm mb-3">Path convention</div>
            <div class="bg-zinc-950 border border-zinc-800 p-6">
                <p class="text-gray-400 mb-4">
                    Use the <span class="text-white">/ws/</span> prefix for WebSocket endpoints to avoid conflicts with HTTP routes.
                </p>
                <pre class="line-numbers"><code class="language-java">// ‚úÖ Good - No conflict
@WebSocket("/ws/chat")      // WebSocket endpoint
@GET("/chat")               // HTTP route (serves HTML page)

// ‚ùå Bad - Path conflict
@WebSocket("/chat")         // ‚ö†Ô∏è Conflicts with HTTP route
@GET("/chat")               // ‚ö†Ô∏è Conflicts with WebSocket</code></pre>
            </div>
        </div>

        <div class="bg-zinc-900 border border-zinc-800 p-6 rounded">
            <div class="text-blue-400 mb-2">üí° Important</div>
            <p class="text-gray-400 text-sm mb-3">
                WebSocket handlers must be placed in the <span class="text-white">fr.kainovaii.obsidian.app.websockets</span> package
                and require <span class="text-white">both</span> annotations:
            </p>
            <ul class="text-gray-400 text-sm space-y-1 ml-4">
                <li>‚Ä¢ <span class="text-white">@WebSocket("/path")</span> - Obsidian annotation</li>
                <li>‚Ä¢ <span class="text-white">@org.eclipse.jetty.websocket.api.annotations.WebSocket</span> - Jetty annotation</li>
            </ul>
        </div>
    </div>
</section>